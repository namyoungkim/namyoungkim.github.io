# 기술 설정 가이드

이 문서는 프로젝트의 핵심 설정 파일들에 대한 상세 설명을 제공합니다.

## 📋 목차

- [docusaurus.config.js](#docusaurusconfigjs)
- [sidebars.js](#sidebarsjs)
- [generate-llms.js](#generate-llmsjs)
- [deploy.yml](#deployyml)
- [llms.txt 생성 메커니즘](#llmstxt-생성-메커니즘)

---

## docusaurus.config.js

메인 설정 파일로 사이트의 모든 주요 설정을 포함합니다.

### 사이트 메타데이터
```javascript
{
  title: '개발 블로그',
  tagline: '기술과 코드, 그리고 배움을 기록합니다',
  favicon: 'img/favicon.png',
  url: 'https://namyoungkim.github.io',
  baseUrl: '/a1rtisan/',
}
```

### 배포 설정 (GitHub Pages)
```javascript
{
  organizationName: 'namyoungkim',  // GitHub 사용자명 또는 조직명
  projectName: 'a1rtisan',           // GitHub 저장소 이름
}
```

**중요**: GitHub Pages 배포 시 이 값들이 URL을 결정합니다:
- 배포 URL: `https://{organizationName}.github.io/{projectName}/`

### i18n 설정
```javascript
i18n: {
  defaultLocale: 'ko',
  locales: ['ko'],  // 한국어만 지원 (영어 제거됨)
}
```

**변경 이력**:
- 이전에는 `['ko', 'en']`으로 영어 지원 포함
- UI에서 언어 선택기 제거와 함께 영어 locale도 제거됨

### 프리셋 설정 (Classic Preset)

#### Docs 설정
```javascript
docs: {
  sidebarPath: require.resolve('./sidebars.js'),
  showLastUpdateTime: false,
  showLastUpdateAuthor: false,
  remarkPlugins: [math],     // 수식 지원
  rehypePlugins: [katex],    // 수식 렌더링
}
```

#### Blog 설정
```javascript
blog: {
  showReadingTime: true,
  postsPerPage: 10,
  blogTitle: '개발 블로그',
  blogDescription: '개발 경험과 지식을 공유합니다',
  blogSidebarTitle: '최근 포스트',
  blogSidebarCount: 10,
  feedOptions: {
    type: 'all',
    title: '개발 블로그',
    description: '개발 경험과 지식을 공유합니다',
    copyright: `Copyright © ${new Date().getFullYear()} Nam Young Kim`,
  },
  remarkPlugins: [math],     // 수식 지원
  rehypePlugins: [katex],    // 수식 렌더링
}
```

**수식 렌더링 설정**:
- `remark-math`: Markdown의 LaTeX 수식을 파싱
- `rehype-katex`: 파싱된 수식을 KaTeX로 렌더링
- ES Module import 시 `.default` 필요:
  ```javascript
  const math = require('remark-math').default;
  const katex = require('rehype-katex').default;
  ```

### 플러그인

#### 이미지 최적화 플러그인
```javascript
plugins: [
  [
    '@docusaurus/plugin-ideal-image',
    {
      quality: 70,      // 이미지 품질 (0-100)
      max: 1030,        // 최대 너비 (px)
      min: 640,         // 최소 너비 (px)
      steps: 2,         // 반응형 이미지 단계 수
      disableInDev: false,
    },
  ],
]
```

### 테마 설정

#### Navbar (상단 네비게이션)
```javascript
navbar: {
  title: '',
  logo: {
    alt: 'A1RTISAN',
    src: 'img/a1rtisan-logo.png',
  },
  items: [
    {
      type: 'docSidebar',
      sidebarId: 'tutorialSidebar',
      position: 'left',
      label: '📚 문서',
    },
    {
      to: '/blog',
      label: '✍️ 블로그',
      position: 'left'
    },
    {
      href: 'https://github.com/namyoungkim/namyoungkim.github.io',
      label: 'GitHub',
      position: 'right',
    },
  ],
}
```

#### Footer (하단 푸터)
```javascript
footer: {
  style: 'dark',
  links: [
    // 문서, 커뮤니티, 더보기, 지원 섹션
  ],
  copyright: `Copyright © ${new Date().getFullYear()} Leo. Built with Docusaurus.`,
}
```

#### 코드 하이라이팅 (Prism)
```javascript
prism: {
  theme: lightCodeTheme,      // GitHub 테마 (라이트 모드)
  darkTheme: darkCodeTheme,   // Dracula 테마 (다크 모드)
  additionalLanguages: ['bash', 'json', 'typescript', 'javascript', 'jsx', 'tsx'],
}
```

#### 다크 모드
```javascript
colorMode: {
  defaultMode: 'light',
  disableSwitch: false,
  respectPrefersColorScheme: true,  // 시스템 설정 자동 반영
}
```

### 스타일시트 (KaTeX CSS)
```javascript
stylesheets: [
  {
    href: 'https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css',
    type: 'text/css',
    integrity: 'sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM',
    crossorigin: 'anonymous',
  },
]
```

수식 렌더링을 위한 KaTeX CSS가 CDN에서 로드됩니다.

### 선택적 통합 (플레이스홀더 상태)

#### Google Analytics
```javascript
gtag: {
  trackingID: 'G-XXXXXXXXXX',  // 실제 ID로 변경 필요
  anonymizeIP: true,
}
```

#### Algolia 검색
```javascript
algolia: {
  appId: 'YOUR_APP_ID',
  apiKey: 'YOUR_SEARCH_API_KEY',
  indexName: 'YOUR_INDEX_NAME',
  contextualSearch: true,
}
```

**참고**: Algolia DocSearch는 https://docsearch.algolia.com/apply/ 에서 신청 가능 (무료)

### 현재 설정 요약

- **URL**: `https://namyoungkim.github.io/`
- **배포**: GitHub Pages 완료
- **i18n**: 한국어만 지원
- **onBrokenLinks**: `'warn'` (템플릿 링크 허용)
- **수식 렌더링**: remark-math + rehype-katex 활성화
- **이미지 최적화**: ideal-image 플러그인 활성화

---

## sidebars.js

문서의 사이드바 구조를 정의하는 파일입니다.

### 기본 구조
```javascript
const sidebars = {
  tutorialSidebar: [
    // 사이드바 아이템들
  ],
};

module.exports = sidebars;
```

### 현재 설정
```javascript
tutorialSidebar: [
  'intro',
  {
    type: 'category',
    label: 'Tutorial',
    items: ['tutorial/getting-started'],
  },
]
```

- `intro.md` 파일이 첫 번째 아이템
- `tutorial/` 폴더가 카테고리로 구성됨

### 자동 생성 옵션
필요시 디렉토리 구조를 자동으로 사이드바에 반영할 수 있습니다:

```javascript
{
  type: 'autogenerated',
  dirName: 'folder',  // docs/folder 내용을 자동 생성
}
```

### 사용 예정
`docs/` 디렉토리는 기술 학습 문서용으로 준비되었습니다:
- React
- TypeScript
- 알고리즘
- 기타 기술 문서

---

## generate-llms.js

LLM 친화적인 `llms.txt` 파일을 자동 생성하는 스크립트입니다.

### 위치
`scripts/generate-llms.js`

### 동작 방식

1. **파일 스캔**
   - `docs/`와 `blog/` 디렉토리의 .md/.mdx 파일을 재귀적으로 스캔

2. **제목 추출**
   - Frontmatter의 `title:` 필드
   - 또는 첫 번째 H1 헤딩 (`# Title`)
   - 또는 파일명 (확장자 제거, `-`와 `_`를 공백으로 치환)

3. **URL 변환**
   - **문서**:
     - `docs/intro.md` → `/docs/intro`
     - `docs/tutorial/getting-started.md` → `/docs/tutorial/getting-started`

   - **블로그**:
     - `blog/2024-01-20-my-post.md` → `/blog/2024/01/20/my-post`
     - 정규식으로 날짜 파싱: `^(\d{4})-(\d{2})-(\d{2})-(.+)$`

4. **출력 생성**
   - `static/llms.txt`에 출력
   - Documentation과 Blog Posts 섹션으로 구분

### 제한사항
- **문서**: 상위 20개 (`intro.md` 우선 표시)
- **블로그**: 최신 10개 (파일명 기준 역순 정렬)

### 실행 방법

#### 수동 실행
```bash
npm run generate:llms
```

#### 자동 실행
`package.json`의 `prebuild` 스크립트로 빌드 전 자동 실행:

```json
{
  "scripts": {
    "prebuild": "npm run generate:llms",
    "build": "docusaurus build"
  }
}
```

`npm run build` 실행 시 자동으로 llms.txt가 먼저 생성됩니다.

---

## deploy.yml

GitHub Actions를 통한 자동 배포 워크플로우 설정 파일입니다.

### 위치
`.github/workflows/deploy.yml`

### 트리거 조건

#### 자동 트리거
```yaml
on:
  push:
    branches:
      - main
    paths:
      - 'docs/**'
      - 'blog/**'
      - 'src/**'
      - 'static/**'
      - 'docusaurus.config.js'
      - 'sidebars.js'
      - 'package.json'
      - 'package-lock.json'
```

다음 조건을 만족할 때 자동으로 배포가 시작됩니다:
- `main` 브랜치에 push
- 콘텐츠(`docs/`, `blog/`) 또는 설정 파일 변경

#### 수동 트리거
```yaml
on:
  workflow_dispatch:
```

GitHub Actions 페이지에서 수동으로 실행 가능합니다.

### 빌드 단계

```yaml
steps:
  - name: Checkout
    uses: actions/checkout@v4
    with:
      fetch-depth: 0  # 전체 git history (마지막 업데이트 시간 표시용)

  - name: Setup Node.js
    uses: actions/setup-node@v4
    with:
      node-version: 20
      cache: npm

  - name: Install dependencies
    run: npm ci

  - name: Generate llms.txt
    run: npm run generate:llms

  - name: Build website
    run: npm run build

  - name: Deploy to GitHub Pages
    uses: peaceiris/actions-gh-pages@v3
    with:
      github_token: ${{ secrets.GITHUB_TOKEN }}
      publish_dir: ./build
```

### 배포 흐름

1. **저장소 체크아웃** - 전체 git history 포함
2. **Node.js 20 설치** - Docusaurus 3.x 요구사항
3. **의존성 설치** - `npm ci` (package-lock.json 기준)
4. **llms.txt 생성** - LLM 친화적 콘텐츠 목록
5. **프로덕션 빌드** - `./build/` 디렉토리 생성
6. **GitHub Pages 배포** - `gh-pages` 브랜치에 배포

### 요구사항

#### Node.js 버전
- **Node.js 20+** 필수 (Docusaurus 3.x 요구사항)

#### GitHub 저장소 설정
1. Settings → Pages로 이동
2. Source를 **"GitHub Actions"**로 설정
3. 변경사항 저장

#### 배포 결과
- URL: `https://namyoungkim.github.io/`
- 배포 시간: 약 2-3분 소요

---

## llms.txt 생성 메커니즘

LLM이 사이트 콘텐츠를 효율적으로 이해할 수 있도록 `llms.txt` 파일을 자동 생성합니다.

### 제목 추출 순서

1. **Frontmatter의 `title:` 필드**
   ```markdown
   ---
   title: 블로그 포스트 제목
   ---
   ```

2. **첫 번째 H1 헤딩**
   ```markdown
   # 문서 제목
   ```

3. **파일명** (확장자 제거, `-`와 `_`를 공백으로 치환)
   - `getting-started.md` → "getting started"

### URL 변환 규칙

#### 문서 (Docs)
- `docs/intro.md` → `/docs/intro`
- `docs/tutorial/getting-started.md` → `/docs/tutorial/getting-started`

파일 경로에서 `docs/` 접두사를 제거하고 확장자를 제거합니다.

#### 블로그 (Blog)
- `blog/2024-01-20-my-post.md` → `/blog/2024/01/20/my-post`

정규식 패턴: `^(\d{4})-(\d{2})-(\d{2})-(.+)$`
- 파일명에서 날짜 부분(`YYYY-MM-DD`)을 추출
- `/blog/YYYY/MM/DD/slug` 형식으로 변환

### 출력 형식

```
# 개발 블로그

> 개발 경험, 튜토리얼, API 문서를 공유하는 기술 블로그

## 📚 Documentation

- /docs/intro: 시작하기
- /docs/tutorial/getting-started: 튜토리얼 시작

## ✍️ Blog Posts

- /blog/2024/12/02/bhattacharyya-distance: Bhattacharyya Distance 쉽게 이해하기
- /blog/2024/12/01/welcome: Data Fullstack Engineer로의 여정
```

### 제한 및 정렬

- **문서**: 최대 20개
  - `intro.md`가 있으면 최우선 표시
  - 나머지는 파일명 순

- **블로그**: 최대 10개
  - 파일명 기준 역순 정렬 (최신글 우선)
  - 날짜 접두사(`YYYY-MM-DD`)로 자동 정렬

### 사용 예시

LLM이 사이트 구조를 빠르게 파악하고 관련 콘텐츠를 찾을 수 있도록 합니다:

```
사용자: "Bhattacharyya Distance에 대한 글이 있나요?"
LLM: llms.txt를 확인 → /blog/2024/12/02/bhattacharyya-distance 발견
```

---

## 🔧 개발 참고사항

### 기술 스택
- **Node.js**: 20+ 필수
- **Docusaurus**: 3.0 (classic preset)
- **코드 하이라이팅**: Prism
  - 라이트 모드: GitHub 테마
  - 다크 모드: Dracula 테마
- **지원 언어**: bash, json, typescript, javascript, jsx, tsx
- **배포**: GitHub Pages + GitHub Actions

### 테스트
- 이 프로젝트에는 테스트 스크립트가 없습니다 (정적 사이트 생성기로 정상)
- **빌드 성공 여부**가 주요 검증 방법:
  ```bash
  npm run build
  ```

### 다크 모드
- 사용자 시스템 설정 자동 반영 (`respectPrefersColorScheme: true`)
- 수동 토글 가능
- `src/css/custom.css`에서 색상 커스터마이징 가능

### 성능
- **정적 사이트 생성 (SSG)**: 모든 페이지가 빌드 시 pre-render
- **이미지 최적화**: ideal-image 플러그인 활성화
- **코드 스플리팅**: 프로덕션 빌드 시 자동 적용
- **Lazy loading**: 이미지와 컴포넌트 자동 lazy load

---

## 🔗 관련 문서

- `CLAUDE.md` - 프로젝트 전체 개요
- `CONTENT-GUIDE.md` - 콘텐츠 작성 가이드
- `README.md` - 프로젝트 소개 및 설치 가이드
- `infrastructure/README.md` - 인프라 전체 개요
